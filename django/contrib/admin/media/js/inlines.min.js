(function(a){a.fn.formset=function(b){var j=a.extend({},a.fn.formset.defaults,b);var i=function(n,o,l){var k=new RegExp("("+o+"-\\d+)");var m=o+"-"+l;if(a(n).attr("for")){a(n).attr("for",a(n).attr("for").replace(k,m))}if(n.id){n.id=n.id.replace(k,m)}if(n.name){n.name=n.name.replace(k,m)}};var f=a("#id_"+j.prefix+"-TOTAL_FORMS");var c=a("#id_"+j.prefix+"-INITIAL_FORMS");var h=(parseInt(f.val())-parseInt(c.val()))>0;var e=this;a(this).each(function(l){a(this).not("."+j.emptyCssClass).addClass(j.formCssClass);if(!a(".errornote").html()){var k=a(e).not("."+j.emptyCssClass);extraRows=k.length;if(parseInt(c.val())>=0){a(k).slice(c.val()).remove()}else{a(k).remove()}f.val(parseInt(c.val()))}});if(a(this).length&&h){var g;if(a(this).attr("tagName")=="TR"){var d=this.eq(0).children().length;a(this).parent().append('<tr class="'+j.addCssClass+'"><td colspan="'+d+'"><a href="javascript:void(0)">'+j.addText+"</a></tr>");g=a(this).parent().find("tr:last a")}else{a(this).filter(":last").after('<div class="'+j.addCssClass+'"><a href="javascript:void(0)">'+j.addText+"</a></div>");g=a(this).filter(":last").next().find("a")}g.click(function(){var n=parseInt(a("#id_"+j.prefix+"-TOTAL_FORMS").val());var m=parseInt(a("#id_"+j.prefix+"-INITIAL_FORMS").val());var k=n+1;var l=a("#"+j.prefix+"-empty");var o=l.clone(true).get(0);a(o).removeClass(j.emptyCssClass).removeAttr("id").insertBefore(a(l));a(o).html(a(o).html().replace(/__prefix__/g,k));a(o).addClass(j.formCssClass).attr("id",j.prefix+k);if(a(o).is("TR")){a(o).children(":last").append('<div><a class="'+j.deleteCssClass+'" href="javascript:void(0)">'+j.deleteText+"</a></div>")}else{if(a(o).is("UL")||a(o).is("OL")){a(o).append('<li><a class="'+j.deleteCssClass+'" href="javascript:void(0)">'+j.deleteText+"</a></li>")}else{a(o).children(":first").append('<span><a class="'+j.deleteCssClass+'" href="javascript:void(0)">'+j.deleteText+"</a></span>")}}a("#id_"+j.prefix+"-TOTAL_FORMS").val(k);if(maxForms<=k){g.parent().hide()}a(o).find("a."+j.deleteCssClass).click(function(){var s=a(this).parents("."+j.formCssClass);s.remove();if(j.removed){j.removed(s)}var p=a("."+j.formCssClass);a("#id_"+j.prefix+"-TOTAL_FORMS").val(p.length);if(maxForms>=p.length){g.parent().show()}for(var q=0,r=p.length;q<r;q++){a(p.get(q)).find("input,select,textarea,label").each(function(){i(this,j.prefix,q)})}return false});a(o).find("input,select,textarea,label").each(function(){i(this,j.prefix,n)});if(j.added){j.added(a(o))}return false})}return a(this)};a.fn.formset.defaults={prefix:"form",addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",emptyCssClass:"empty-row",formCssClass:"dynamic-form",added:null,removed:null}})(jQuery);